# STRIDE Threat Model – AMAPP Authentication DFD

| **Threat**                         | **Targeted Element**           | **STRIDE Category**    | **Description**                                                                                                                                       | **Mitigation**                                                                                                         |
|-----------------------------------|--------------------------------|------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------|
| **AA01 – Authentication Bypass**  | AMAPP API                      | Spoofing               | Attackers try to bypass login logic (e.g., reusing expired tokens, skipping auth headers).                                                           | Enforce strong JWT validation; validate token expiration and audience; use HTTPS.                                     |
| **AC20 – Session Replay**         | AMAPP API                      | Tampering              | Reuse of valid JWT tokens captured via network sniffing or exposed endpoints.                                                                         | Short token lifetimes, one-time tokens, token rotation, and HTTPS enforcement.                                        |
| **CR03 – Password Brute Force**   | AMAPP API                      | Denial of Service      | Repeated login attempts using dictionaries or brute force degrade availability and risk account compromise.                                          | Rate limiting, CAPTCHA, account lockout mechanisms, and logging failed attempts.                                       |
| **INP09 – LDAP Injection**        | AMAPP API, AMAPP DB            | Tampering              | Malformed input could be used in login queries (if LDAP used), allowing access or privilege escalation.                                              | Use parameterized queries; sanitize all inputs; validate schema and types.                                             |
| **INP02 – Buffer Overflow**       | AMAPP API                      | Tampering              | Poorly validated login fields could trigger buffer overflows (unlikely in .NET but still a concern in native components).                           | Use safe string handling, input size limits, memory-safe languages.                                                   |
| **DS01 – Excavation**             | AMAPP API                      | Information Disclosure | Error messages or verbose logs during login may reveal implementation details (e.g., username exists, stack traces).                                 | Standardize error messages, suppress stack traces, sanitize logs.                                                     |
| **AC01 – Privilege Abuse**        | AMAPP API                      | Elevation of Privilege | JWT manually modified to elevate role to admin (e.g., modifying payload manually).                                                                   | Validate JWT signature and claims server-side; use asymmetric signing (RS256); never trust client-provided roles.     |
| **DE04 – Audit Log Manipulation** | AMAPP DB                       | Repudiation            | If logs are not secured, a user might deny having authenticated or erase traces of login events.                                                     | Use append-only log structures; timestamp and sign logs; store logs in secure datastore with restricted write access. |